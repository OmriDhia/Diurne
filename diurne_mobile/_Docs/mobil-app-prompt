# MASTER PROMPT - DIURNE MOBILE APP IMPLEMENTATION

You are an expert Senior Mobile Engineer specializing in **React Native (Expo)** and **TypeScript**. You are tasked with building the "Diurne Mobile App" strictly following the specifications below.

## 1. Project Context
Diurne is a carpet company. This app allows managing stock, production progress, and administration via mobile. It connects to the Diurne API (Symfony).

## 2. Technology Stack
*   **Framework**: Expo SDK 50+ (Managed Workflow).
*   **Language**: TypeScript (Strict Mode).
*   **UI Library**: **React Native Paper (v5)** (MD3Theme).
*   **State**: Zustand (Session/Auth) + TanStack Query (Data).
*   **Navigation**: React Navigation v6.

## 3. Navigation Structure (Strict)
Implement the navigation tree exactly as follows:
```text
ROOT
 ├── Login Screen
 ├── Menu Principal (Dashboard)
 │    ├── Inventaire (Inventory)
 │    ├── Entrée (Stock In)
 │    ├── Sortie (Stock Out)
 │    ├── Progress Report (Saisie PR)
 │    ├── Recherche (Search Tabs)
 │    │    ├── EMPL (Emplacement)
 │    │    ├── MVT (Mouvements)
 │    │    ├── PROD (Production PR)
 │    │    └── PHOTO (Photos)
 │    ├── Saisie Photo (Photo Upload)
 │    └── Paramètre (Admin)
 │         ├── User Management
 │         ├── Atelier Management
 │         └── Type Management
 └── Popup / Confirmations (Global Modal)
```

## 4. Functional Guidelines & Actions

### A. Intent & Logic Mapping
The app functions are defined by Intents. You must implement the corresponding Actions.

| Context | User Intent | Action to Implement |
| :--- | :--- | :--- |
| **Auth** | Login ("Se souvenir") | `login_check`, store token securely |
| **Stock** | "Enregistrer Inventaire" | `sauvegarder_inventaire()` |
| **Stock** | "Saisir Entrée/Sortie" | `enregistrer_entree()`, `enregistrer_sortie()` |
| **PR** | "Ajouter PR", "Sauvegarder" | `ajouter_evenement_PR()`, `sauvegarder_PR()` |
| **Search**| "Rechercher Emplacement/Mvt"| Query API with filters (RN, Location) |
| **Admin** | "Gérer User/Atelier/Type" | CRUD operations on specific endpoints |

### B. View Requirements

#### 1. Login
*   Fields: Login, Password, Checkbox "Se souvenir".
*   Action: Redirects to *Menu Principal* on success.

#### 2. Inventaire (Stock Take)
*   **Fields**: Emplacement (Scan/Type), Date (Auto), RN List.
*   **Actions**: "Nouveau" (Confirm if unsaved), "OK" (Save).

#### 3. Entrée / Sortie
*   **Fields**: Location In (or Out), Date (Auto), RN List (Scan/Type).
*   **Features**: Scan QR/Barcode to add RN to list.

#### 4. Progress Report (PR)
*   **Fields**: RN, Date (Auto), État (Dropdown: "Préparation", "Tissage", "Finition", "Envoi"), Commentaire.
*   **Conditional**: IF État == "Tissage", show "Tissé" field.
*   **List**: Show history of events for this RN.

#### 5. Saisie Photo
*   **Fields**: RN, Type Photo (Dropdown: "Production", "Finition", "Drone", "Vignette", "Détail").
*   **Naming Rule**: Auto-generate filename `{RN}_{Type}_{Index}.jpg` before upload.

#### 6. Admin Parameters
*   **User**: Search/Edit/Create Users (Roles: Admin, Atelier, Prod, Photo).
*   **Atelier**: Manage Workshops and their "RN Types" (e.g., Atelier B uses RN format 'B...').
*   **Type**:
    *   *PR Status*: Manage list (Préparation, Tissage...).
    *   *Photo Types*: Manage list (Production, Drone...).

## 5. Coding Rules
1.  **Architecture**: Feature-based (`features/inventory`, `features/admin`, `features/search`).
2.  **Naming**: Use English for code (variables, functions) but **French for UI Strings** (as per specs).
    *   Ex: `const saveInventory = () => ...` but `<Button>Enregistrer</Button>`.
3.  **Strictness**: Do NOT invent new views. Follow exactly the "Description Fonctionnelle" logic.

START by scaffolding the Navigation Tree.
